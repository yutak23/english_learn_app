# 英単語 SRS 学習アプリ - 要件定義書

忘却曲線と SRS（Spaced Repetition System）に基づいて英単語を学習するWebアプリケーションです。

単語データは複数の JSON ファイルから読み込み、学習履歴はブラウザの `localStorage` のみで管理します。

---

## 機能要件

### コア機能

- **単語データ管理**
  - 複数の JSON ファイルから単語を読み込み、マージ
  - 単語の重複チェック（エラー表示）
  - 必須フィールド: `word`（識別子）、`meaning`（日本語の意味）
  - オプションフィールド: 発音記号、品詞、例文、訳文など

- **学習フロー**
  - **5単語1セット制**: 1セット内の全単語をクリアするまで繰り返し出題
  - 3段階評価: `Forgot`（忘れた）、`Remembered`（覚えていた）、`Perfect`（完璧）
  - セット内で `Forgot` を選んだ単語の再出題時は `Perfect` 選択肢を非表示
  - **マスター**: `Perfect` を選択した単語を「マスター済み」とする

- **SRS（間隔反復）**
  - 間隔反復アルゴリズムで次回出題タイミングを最適化
  - 1日の学習上限なし、学習対象がある限り出題
  - 全単語学習済みの場合も、忘れやすい単語を継続出題

- **セッション管理**
  - フローティングボタン（`Start Session` / `Stop Session`）で制御
  - セッション単位の総学習時間と学習単語数を記録

- **時間計測**
  - セッション単位の総学習時間
  - 単語1問ごとの回答時間
  - 単語別・日別の累積時間

- **音声再生**
  - Web Speech API による英単語の発音再生

- **データ管理**
  - エクスポート: 学習履歴を JSON でダウンロード
  - インポート: JSON データで既存データを完全上書き
  - データ保持: 学習ログを無限に蓄積（手動削除まで）

- **レポート**
  - 日別学習単語数（期間フィルタ付き）
  - 単語ごとのマスター度
  - 日別学習時間
  - 苦手単語リスト
  - 学習継続性（ストリーク）
  - localStorage 使用容量

- **エラーハンドリング**
  - JSON 読み込みエラー表示
  - 単語重複エラー表示
  - localStorage 書き込みエラー通知

- **ローディング状態**
  - JSON 読み込み中、データエクスポート中、音声再生中のフィードバック

---

## 単語データ（JSON）

### データ形式

**必須フィールド:**
- `word`: 英単語（識別子）
- `meaning`: 日本語の意味

**オプションフィールド:**
- `pronunciation`: 発音記号
- `katakana`: カタカナ読み
- `type`: 品詞
- `contextMeaning`: 文脈での意味
- `example`: 例文
- `translation`: 例文の訳
- `sentenceBreakdown`: 文の構造解析
- `wordByWordTranslation`: 単語ごとの訳
- `derivatives`: 派生語リスト

データ形式の詳細とサンプルは [DESIGN.md](./DESIGN.md) を参照してください。

---

## 用語の定義

- **Study（学習）**: 単語を出題し、ユーザーが回答する行為全般。「復習（Review）」は使用しない。
- **Mastered（マスター）**: `Perfect` を選択した単語の状態。
- **Set（セット）**: 5単語をまとめた学習単位。
- **Session（セッション）**: 学習開始から終了までの時間的区切り。
- **SRS / Spaced Repetition**: 単語ごとの次回出題タイミングを決定するアルゴリズム。

---

## 画面構成

**UI言語**: すべて英語表記

### Home 画面

| 要素 | 内容 |
|------|------|
| ボタン | `Start Study`, `View Report`, `Settings` |
| サマリ | 今日の学習数、マスター済み単語数、学習時間、連続学習日数 |

### Study 画面

| 要素 | 内容 |
|------|------|
| 学習フロー | 5単語1セット、セット完了まで繰り返し |
| セッション制御 | `Start Session` / `Stop Session` フローティングボタン |
| 単語表示 | 英単語、発音記号、品詞、意味、例文、訳文 |
| 意味切り替え | タップで意味の表示/非表示（必須機能） |
| 音声 | スピーカーアイコンで発音再生 |
| 回答ボタン | `Forgot`（赤）、`Remembered`（黄）、`Perfect`（緑）<br>※ セット内で `Forgot` 選択後は `Perfect` 非表示 |
| 進捗表示 | 今日の学習数、累計学習数、現在のセット進捗 |

### Report 画面

| セクション | 内容 |
|-----------|------|
| Overview | 総学習日数、総学習回数、マスター済み単語数、ストリーク、ストレージ使用量 |
| Daily Studies | 日別学習数（期間フィルタ、グラフ表示） |
| Word Mastery | 全単語のマスター度（New, Learning, Stable, Mastered）、ソート機能 |
| Weak Words | 苦手単語リスト（正解率、最終学習日） |
| Study Time | 日別学習時間（グラフ、平均時間） |

### Settings 画面

| セクション | 内容 |
|-----------|------|
| Data Management | Export/Import/Reset、ストレージ使用量表示 |
| Word Files | 読み込む単語ファイルのリスト、追加・削除 |
| About | バージョン情報、ヘルプリンク |

---

## 非機能要件

### アーキテクチャ制約
- **バックエンド**: 不要（完全フロントエンドアプリ）
- **永続化**: ブラウザの localStorage のみ使用
- **オフライン**: 完全オフラインで動作
- **音声**: ブラウザ標準の音声合成 API を使用
- **データ形式**: JSON ファイル形式で単語データを管理

### 環境
- **対応ブラウザ**: Chrome（最新版）
- **対象デバイス**: スマートフォン
- **操作方法**: タップ・クリック操作

### パフォーマンス
- 5000単語程度の JSON ファイルでも動作

### 日付と時刻
- **タイムゾーン**: JST（日本標準時）
- **日付境界**: 深夜0時（JST）
- **時刻取得**: ブラウザの OS 時刻

### 制約
- 単語削除は想定しない
- localStorage 容量は無限蓄積（定期的なバックアップを推奨）

### スコープ外
- スクリーンリーダー対応
- キーボード操作
- Chrome以外のブラウザ保証

---

**関連ドキュメント**:
- 詳細な設計、データモデル、アルゴリズムについては [DESIGN.md](./DESIGN.md) を参照
- 開発優先順位とフェーズ計画については [ROADMAP.md](./ROADMAP.md) を参照
